# ACMA Script - Monitoring Thresholds
# Version: 2.0.0

#================================================
# DDoS DETECTION THRESHOLDS
#================================================
[ddos]
# Connections per IP
conn_per_ip_warning = 100
conn_per_ip_critical = 300
conn_per_ip_block = 500

# Requests per second (per IP)
req_per_sec_warning = 50
req_per_sec_critical = 100
req_per_sec_block = 200

# Total connections
total_conn_warning = 5000
total_conn_critical = 10000

# Bandwidth (Mbps)
bandwidth_warning = 100
bandwidth_critical = 500
bandwidth_emergency = 1000

# SYN flood detection
syn_per_sec_warning = 100
syn_per_sec_critical = 500
syn_per_sec_block = 1000

# UDP flood detection
udp_per_sec_warning = 500
udp_per_sec_critical = 2000

# HTTP flood (same URL)
same_url_per_min_warning = 100
same_url_per_min_block = 500

# Block durations (seconds)
block_duration_level1 = 300       # 5 minutes
block_duration_level2 = 3600      # 1 hour
block_duration_level3 = 86400     # 24 hours
block_duration_level4 = 604800    # 7 days

# Auto-unblock after threshold
auto_unblock_enabled = true
auto_unblock_check_interval = 300

#================================================
# RAM THRESHOLDS
#================================================
[ram]
# Usage percentage thresholds
warning_percent = 80
critical_percent = 90
emergency_percent = 95

# Swap thresholds
swap_warning_percent = 50
swap_critical_percent = 80

# OOM Killer prevention
oom_prevention_enabled = true
oom_prevention_threshold = 95

# Auto actions
auto_clear_cache_enabled = true
auto_clear_cache_threshold = 90
auto_kill_process_enabled = false
auto_kill_process_threshold = 95

# Check interval (seconds)
check_interval = 5

# Sustained high usage (seconds before alert)
sustained_seconds = 60

#================================================
# CPU THRESHOLDS
#================================================
[cpu]
# Usage percentage thresholds
warning_percent = 80
critical_percent = 95

# Load average thresholds (multiplier of CPU cores)
load_warning_multiplier = 1.5
load_critical_multiplier = 3.0

# Sustained high usage (seconds before alert)
sustained_seconds = 300

# Check interval (seconds)
check_interval = 5

# Per-process CPU limit
process_cpu_warning = 80
process_cpu_critical = 95

#================================================
# DISK THRESHOLDS
#================================================
[disk]
# Usage percentage thresholds
warning_percent = 80
critical_percent = 90
emergency_percent = 95

# Inode thresholds
inode_warning_percent = 80
inode_critical_percent = 90

# I/O wait thresholds (percentage)
iowait_warning = 30
iowait_critical = 50

# Auto cleanup
auto_cleanup_enabled = true
auto_cleanup_threshold = 90
auto_cleanup_log_days = 7
auto_cleanup_tmp_days = 1
auto_cleanup_backup_days = 30

# Check interval (seconds)
check_interval = 60

#================================================
# NETWORK THRESHOLDS
#================================================
[network]
# Packet loss percentage
packet_loss_warning = 5
packet_loss_critical = 20

# Latency (ms)
latency_warning = 100
latency_critical = 500

# Interface errors per minute
interface_errors_warning = 100
interface_errors_critical = 1000

# Check interval (seconds)
check_interval = 30

#================================================
# SERVICE THRESHOLDS
#================================================
[service]
# Health check interval (seconds)
check_interval = 10

# Max restart attempts before alert
max_restart_attempts = 3
restart_cooldown = 300

# Response timeout (seconds)
nginx_timeout = 5
php_fpm_timeout = 5
mysql_timeout = 10

# Auto restart on failure
auto_restart_enabled = true
auto_restart_delay = 5

#================================================
# SYSTEM HANG DETECTION
#================================================
[system]
# Hang detection timeout (seconds)
hang_timeout = 30

# Watchdog interval (seconds)
watchdog_interval = 5

# Max load before considered hanging
max_load_multiplier = 10

# Zombie process threshold
zombie_warning = 10
zombie_critical = 50

# File descriptor usage
fd_warning_percent = 80
fd_critical_percent = 95

# Auto reboot on hang (DANGEROUS)
auto_reboot_on_hang = false
auto_reboot_timeout = 120

#================================================
# SECURITY THRESHOLDS
#================================================
[security]
# SSH brute force
ssh_failed_warning = 5
ssh_failed_block = 10
ssh_block_duration = 3600

# HTTP auth brute force
http_auth_failed_warning = 10
http_auth_failed_block = 20
http_auth_block_duration = 3600

# 404/403 errors (per minute per IP)
error_rate_warning = 50
error_rate_block = 100

# File change detection
file_change_check_interval = 3600
file_change_alert = true

# Rootkit scan interval (hours)
rootkit_scan_interval = 24

# Malware scan interval (hours)
malware_scan_interval = 24

#================================================
# SSL THRESHOLDS
#================================================
[ssl]
# Days before expiry
expiry_warning_days = 30
expiry_critical_days = 7
expiry_emergency_days = 1

# Check interval (hours)
check_interval = 24

# Auto renew
auto_renew_enabled = true
auto_renew_days_before = 30

#================================================
# BACKUP THRESHOLDS
#================================================
[backup]
# Max backup age (hours)
max_age_warning = 30
max_age_critical = 48

# Min backup size (bytes, 0 = disabled)
min_size = 1024

# Disk space required (percentage)
disk_space_required = 10
