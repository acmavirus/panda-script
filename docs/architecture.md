# Kiáº¿n trÃºc há»‡ thá»‘ng Panda Script v2.0

## ðŸ“‹ Tá»•ng quan

Panda Script v2.0 Ä‘Æ°á»£c thiáº¿t káº¿ vá»›i kiáº¿n trÃºc **event-driven**, **modular** vÃ  **high-performance**, táº­p trung vÃ o:
- ðŸš€ **Hiá»‡u suáº¥t cao**: Async processing, caching, optimized configs
- ðŸ”’ **Báº£o máº­t Ä‘a lá»›p**: Defense in depth, real-time threat detection
- ðŸ“¢ **Cáº£nh bÃ¡o thÃ´ng minh**: Telegram alerts cho DDoS, RAM, System hang
- ðŸ“Š **Monitoring proactive**: PhÃ¡t hiá»‡n sá»›m cÃ¡c váº¥n Ä‘á»

---

## ðŸ—ï¸ Kiáº¿n trÃºc tá»•ng thá»ƒ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          ðŸ¼ Panda Script v2.0                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                        ðŸ”” ALERT SYSTEM                                  â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚   Telegram   â”‚ â”‚    Email     â”‚ â”‚   Webhook    â”‚ â”‚   Discord    â”‚   â”‚ â”‚
â”‚  â”‚  â”‚    Bot API   â”‚ â”‚    SMTP      â”‚ â”‚   Custom     â”‚ â”‚   Webhook    â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â–²                                       â”‚
â”‚                                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                     ðŸ›¡ï¸ SECURITY & MONITORING LAYER                     â”‚ â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â”‚  â”‚   DDoS     â”‚ â”‚   RAM      â”‚ â”‚  System    â”‚ â”‚   Intrusion        â”‚   â”‚ â”‚
â”‚  â”‚  â”‚  Detector  â”‚ â”‚  Monitor   â”‚ â”‚  Health    â”‚ â”‚   Detection        â”‚   â”‚ â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                      â–²                                       â”‚
â”‚                                      â”‚                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚   CLI Menu   â”‚   â”‚  Installer   â”‚ â”‚ â”‚   Updater    â”‚                     â”‚
â”‚  â”‚   (panda)    â”‚   â”‚   (install)  â”‚ â”‚ â”‚   (update)   â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
â”‚         â”‚                  â”‚         â”‚        â”‚                              â”‚
â”‚         â–¼                  â–¼         â”‚        â–¼                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                         CORE ENGINE                                  â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚    â”‚
â”‚  â”‚  â”‚ Common  â”‚ â”‚   OS    â”‚ â”‚ Network â”‚ â”‚Security â”‚ â”‚  Performanceâ”‚   â”‚    â”‚
â”‚  â”‚  â”‚Functionsâ”‚ â”‚ Detect  â”‚ â”‚  Utils  â”‚ â”‚  Core   â”‚ â”‚   Tuner     â”‚   â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â”‚                                               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚         â–¼                    â–¼                    â–¼                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚    Modules     â”‚  â”‚    Modules     â”‚  â”‚    Modules     â”‚                â”‚
â”‚  â”‚   (Website)    â”‚  â”‚  (Database)    â”‚  â”‚  (Security)    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ Cáº¥u trÃºc Source Code tá»‘i Æ°u

```
panda-script/
â”‚
â”œâ”€â”€ install                          # Entry point - Main installer
â”œâ”€â”€ panda                            # CLI management tool
â”œâ”€â”€ update                           # Script updater
â”‚
â”œâ”€â”€ core/                            # ðŸ”¥ Core Engine (Performance Critical)
â”‚   â”œâ”€â”€ init.sh                     # Bootstrap & initialization
â”‚   â”œâ”€â”€ common.sh                   # Colors, logging, prompts
â”‚   â”œâ”€â”€ os_detect.sh                # OS detection & validation
â”‚   â”œâ”€â”€ package.sh                  # Package manager abstraction
â”‚   â”œâ”€â”€ service.sh                  # Service management
â”‚   â”œâ”€â”€ network.sh                  # Network utilities
â”‚   â””â”€â”€ utils.sh                    # General utilities
â”‚
â”œâ”€â”€ security/                        # ðŸ›¡ï¸ Security Layer
â”‚   â”œâ”€â”€ firewall/
â”‚   â”‚   â”œâ”€â”€ firewall.sh            # Firewall management
â”‚   â”‚   â”œâ”€â”€ iptables_rules.sh      # IPTables advanced rules
â”‚   â”‚   â”œâ”€â”€ rate_limit.sh          # Connection rate limiting
â”‚   â”‚   â””â”€â”€ geo_block.sh           # Country-based blocking
â”‚   â”‚
â”‚   â”œâ”€â”€ ddos/
â”‚   â”‚   â”œâ”€â”€ detector.sh            # DDoS detection engine
â”‚   â”‚   â”œâ”€â”€ mitigation.sh          # Auto-mitigation actions
â”‚   â”‚   â”œâ”€â”€ blacklist.sh           # IP blacklist management
â”‚   â”‚   â””â”€â”€ whitelist.sh           # Trusted IPs
â”‚   â”‚
â”‚   â”œâ”€â”€ intrusion/
â”‚   â”‚   â”œâ”€â”€ fail2ban.sh            # fail2ban management
â”‚   â”‚   â”œâ”€â”€ aide.sh                # File integrity
â”‚   â”‚   â”œâ”€â”€ rootkit_scan.sh        # Rootkit detection
â”‚   â”‚   â””â”€â”€ malware_scan.sh        # Malware scanning
â”‚   â”‚
â”‚   â”œâ”€â”€ hardening/
â”‚   â”‚   â”œâ”€â”€ ssh_harden.sh          # SSH security
â”‚   â”‚   â”œâ”€â”€ kernel_harden.sh       # Kernel parameters
â”‚   â”‚   â”œâ”€â”€ permission_audit.sh    # Permission checker
â”‚   â”‚   â””â”€â”€ ssl_audit.sh           # SSL/TLS audit
â”‚   â”‚
â”‚   â””â”€â”€ audit/
â”‚       â”œâ”€â”€ security_scan.sh       # Full security scan
â”‚       â”œâ”€â”€ vulnerability.sh       # CVE checking
â”‚       â””â”€â”€ report.sh              # Security reports
â”‚
â”œâ”€â”€ monitoring/                      # ðŸ“Š Monitoring & Alerting
â”‚   â”œâ”€â”€ collectors/
â”‚   â”‚   â”œâ”€â”€ cpu_collector.sh       # CPU metrics
â”‚   â”‚   â”œâ”€â”€ ram_collector.sh       # RAM metrics
â”‚   â”‚   â”œâ”€â”€ disk_collector.sh      # Disk metrics
â”‚   â”‚   â”œâ”€â”€ network_collector.sh   # Network metrics
â”‚   â”‚   â””â”€â”€ service_collector.sh   # Service health
â”‚   â”‚
â”‚   â”œâ”€â”€ analyzers/
â”‚   â”‚   â”œâ”€â”€ threshold_analyzer.sh  # Threshold checking
â”‚   â”‚   â”œâ”€â”€ trend_analyzer.sh      # Trend detection
â”‚   â”‚   â”œâ”€â”€ anomaly_detector.sh    # Anomaly detection
â”‚   â”‚   â””â”€â”€ correlation.sh         # Event correlation
â”‚   â”‚
â”‚   â”œâ”€â”€ alerts/
â”‚   â”‚   â”œâ”€â”€ alert_manager.sh       # Alert orchestration
â”‚   â”‚   â”œâ”€â”€ telegram.sh            # Telegram notifications
â”‚   â”‚   â”œâ”€â”€ email.sh               # Email notifications
â”‚   â”‚   â”œâ”€â”€ webhook.sh             # Webhook calls
â”‚   â”‚   â””â”€â”€ discord.sh             # Discord notifications
â”‚   â”‚
â”‚   â””â”€â”€ daemon/
â”‚       â”œâ”€â”€ monitor_daemon.sh      # Background monitor
â”‚       â”œâ”€â”€ health_check.sh        # System health
â”‚       â””â”€â”€ watchdog.sh            # Process watchdog
â”‚
â”œâ”€â”€ performance/                     # ðŸš€ Performance Optimization
â”‚   â”œâ”€â”€ tuning/
â”‚   â”‚   â”œâ”€â”€ auto_tune.sh           # Auto performance tuning
â”‚   â”‚   â”œâ”€â”€ nginx_tune.sh          # Nginx optimization
â”‚   â”‚   â”œâ”€â”€ php_tune.sh            # PHP optimization
â”‚   â”‚   â”œâ”€â”€ mysql_tune.sh          # MariaDB optimization
â”‚   â”‚   â””â”€â”€ kernel_tune.sh         # Kernel parameters
â”‚   â”‚
â”‚   â”œâ”€â”€ cache/
â”‚   â”‚   â”œâ”€â”€ opcache.sh             # PHP OPcache
â”‚   â”‚   â”œâ”€â”€ redis.sh               # Redis cache
â”‚   â”‚   â”œâ”€â”€ memcached.sh           # Memcached
â”‚   â”‚   â””â”€â”€ nginx_cache.sh         # Nginx FastCGI cache
â”‚   â”‚
â”‚   â””â”€â”€ benchmark/
â”‚       â”œâ”€â”€ stress_test.sh         # Load testing
â”‚       â”œâ”€â”€ benchmark.sh           # Performance benchmark
â”‚       â””â”€â”€ report.sh              # Performance reports
â”‚
â”œâ”€â”€ modules/                         # ðŸ“¦ Feature Modules
â”‚   â”œâ”€â”€ nginx/
â”‚   â”‚   â”œâ”€â”€ install.sh
â”‚   â”‚   â”œâ”€â”€ config.sh
â”‚   â”‚   â”œâ”€â”€ vhost.sh
â”‚   â”‚   â”œâ”€â”€ security.sh            # Nginx security
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â”œâ”€â”€ nginx.conf.tpl
â”‚   â”‚       â”œâ”€â”€ vhost.conf.tpl
â”‚   â”‚       â”œâ”€â”€ security.conf.tpl
â”‚   â”‚       â””â”€â”€ cache.conf.tpl
â”‚   â”‚
â”‚   â”œâ”€â”€ mariadb/
â”‚   â”‚   â”œâ”€â”€ install.sh
â”‚   â”‚   â”œâ”€â”€ config.sh
â”‚   â”‚   â”œâ”€â”€ user.sh
â”‚   â”‚   â”œâ”€â”€ backup.sh
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â””â”€â”€ my.cnf.tpl
â”‚   â”‚
â”‚   â”œâ”€â”€ php/
â”‚   â”‚   â”œâ”€â”€ install.sh
â”‚   â”‚   â”œâ”€â”€ config.sh
â”‚   â”‚   â”œâ”€â”€ extensions.sh
â”‚   â”‚   â””â”€â”€ templates/
â”‚   â”‚       â”œâ”€â”€ php.ini.tpl
â”‚   â”‚       â””â”€â”€ pool.conf.tpl
â”‚   â”‚
â”‚   â”œâ”€â”€ website/
â”‚   â”‚   â”œâ”€â”€ create.sh
â”‚   â”‚   â”œâ”€â”€ delete.sh
â”‚   â”‚   â”œâ”€â”€ list.sh
â”‚   â”‚   â”œâ”€â”€ wordpress.sh
â”‚   â”‚   â””â”€â”€ laravel.sh
â”‚   â”‚
â”‚   â”œâ”€â”€ ssl/
â”‚   â”‚   â”œâ”€â”€ letsencrypt.sh
â”‚   â”‚   â”œâ”€â”€ self_signed.sh
â”‚   â”‚   â””â”€â”€ renew.sh
â”‚   â”‚
â”‚   â””â”€â”€ backup/
â”‚       â”œâ”€â”€ local.sh
â”‚       â”œâ”€â”€ remote.sh
â”‚       â”œâ”€â”€ gdrive.sh
â”‚       â”œâ”€â”€ s3.sh
â”‚       â””â”€â”€ restore.sh
â”‚
â”œâ”€â”€ menu/                            # ðŸ–¥ï¸ Menu System
â”‚   â”œâ”€â”€ main.sh
â”‚   â”œâ”€â”€ website.sh
â”‚   â”œâ”€â”€ database.sh
â”‚   â”œâ”€â”€ ssl.sh
â”‚   â”œâ”€â”€ backup.sh
â”‚   â”œâ”€â”€ php.sh
â”‚   â”œâ”€â”€ nginx.sh
â”‚   â”œâ”€â”€ security.sh
â”‚   â”œâ”€â”€ monitoring.sh
â”‚   â””â”€â”€ system.sh
â”‚
â”œâ”€â”€ config/                          # âš™ï¸ Configuration
â”‚   â”œâ”€â”€ panda.conf                  # Main config
â”‚   â”œâ”€â”€ alerts.conf                 # Alert settings
â”‚   â”œâ”€â”€ thresholds.conf             # Monitoring thresholds
â”‚   â””â”€â”€ security.conf               # Security settings
â”‚
â”œâ”€â”€ data/                            # ðŸ’¾ Runtime Data
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ panda.db                # SQLite database
â”‚   â”œâ”€â”€ cache/
â”‚   â”œâ”€â”€ logs/
â”‚   â””â”€â”€ tmp/
â”‚
â”œâ”€â”€ docs/                            # ðŸ“š Documentation
â”‚
â””â”€â”€ tests/                           # ðŸ§ª Tests
    â”œâ”€â”€ unit/
    â”œâ”€â”€ integration/
    â””â”€â”€ security/
```

---

## ðŸ”” Há»‡ thá»‘ng Cáº£nh bÃ¡o Telegram

### Kiáº¿n trÃºc Alert System

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ALERT SYSTEM FLOW                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚   Monitor   â”‚â”€â”€â”€â”€â–¶â”‚  Analyzer   â”‚â”€â”€â”€â”€â–¶â”‚   Alert     â”‚       â”‚
â”‚  â”‚   Daemon    â”‚     â”‚   Engine    â”‚     â”‚   Manager   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜       â”‚
â”‚                                                  â”‚               â”‚
â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”         â”‚
â”‚         â–¼                â–¼               â–¼           â–¼         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Telegram  â”‚  â”‚   Email    â”‚  â”‚  Discord   â”‚ â”‚Webhook â”‚    â”‚
â”‚  â”‚    Bot     â”‚  â”‚   SMTP     â”‚  â”‚   Webhook  â”‚ â”‚ Custom â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Cáº¥u hÃ¬nh Telegram (`config/alerts.conf`)

```ini
[telegram]
enabled = true
bot_token = "YOUR_BOT_TOKEN"
chat_id = "-100123456789"
# CÃ³ thá»ƒ thÃªm nhiá»u chat_id
chat_ids = "-100123456789,-100987654321"

# Alert levels
alert_critical = true
alert_warning = true
alert_info = false

# Rate limiting (trÃ¡nh spam)
rate_limit = 60              # seconds between same alerts
daily_limit = 100            # max alerts per day

# Templates
template_dir = "/opt/panda/templates/alerts"
```

### CÃ¡c loáº¡i cáº£nh bÃ¡o

| Alert Type | Trigger | Severity | Action |
|------------|---------|----------|--------|
| DDoS Attack | >1000 conn/IP/min | ðŸ”´ Critical | Auto-block IP + Alert |
| RAM Full | >90% usage | ðŸ”´ Critical | Kill process + Alert |
| RAM High | >80% usage | ðŸŸ¡ Warning | Alert only |
| System Hang | No response 30s | ðŸ”´ Critical | Force restart + Alert |
| CPU Overload | >95% for 5min | ðŸŸ¡ Warning | Alert + log |
| Disk Full | >90% usage | ðŸ”´ Critical | Alert + cleanup |
| Service Down | nginx/php/mysql | ðŸ”´ Critical | Auto-restart + Alert |
| SSH Brute Force | >10 failed/min | ðŸŸ¡ Warning | Block IP + Alert |
| SSL Expiring | <7 days | ðŸŸ¡ Warning | Alert only |

---

## ðŸ›¡ï¸ DDoS Detection & Mitigation

### Detection Algorithm

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    DDoS DETECTION ENGINE                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   Data Collectors                        â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚    â”‚
â”‚  â”‚  â”‚  Netstat  â”‚ â”‚  IPTables â”‚ â”‚  Nginx    â”‚ â”‚  SS     â”‚ â”‚    â”‚
â”‚  â”‚  â”‚  Monitor  â”‚ â”‚   Logs    â”‚ â”‚   Logs    â”‚ â”‚ Stats   â”‚ â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   Analysis Engine                        â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ Connection Rate Analysis (conn/sec per IP)           â”‚    â”‚
â”‚  â”‚  â€¢ Request Pattern Analysis (same URL attacks)          â”‚    â”‚
â”‚  â”‚  â€¢ Geographic Anomaly (unusual country traffic)         â”‚    â”‚
â”‚  â”‚  â€¢ Protocol Anomaly (SYN flood, UDP flood)              â”‚    â”‚
â”‚  â”‚  â€¢ Bandwidth Anomaly (sudden spikes)                    â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   Threat Classification                  â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  Level 1: Suspicious  â†’ Monitor + Log                   â”‚    â”‚
â”‚  â”‚  Level 2: Likely      â†’ Rate Limit + Alert              â”‚    â”‚
â”‚  â”‚  Level 3: Confirmed   â†’ Block + Mitigate + Alert        â”‚    â”‚
â”‚  â”‚  Level 4: Severe      â†’ Emergency Mode + Full Alert     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                              â–¼                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                   Mitigation Actions                     â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â”‚  â€¢ IP Blacklist (auto + manual)                         â”‚    â”‚
â”‚  â”‚  â€¢ Rate Limiting (nginx + iptables)                     â”‚    â”‚
â”‚  â”‚  â€¢ Connection Limiting                                   â”‚    â”‚
â”‚  â”‚  â€¢ Geographic Blocking                                   â”‚    â”‚
â”‚  â”‚  â€¢ Cloudflare API (if configured)                       â”‚    â”‚
â”‚  â”‚  â€¢ Null Route (extreme cases)                           â”‚    â”‚
â”‚  â”‚                                                          â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Thresholds (`config/thresholds.conf`)

```ini
[ddos]
# Connection thresholds per IP
conn_per_ip_warning = 100
conn_per_ip_critical = 300
conn_per_ip_block = 500

# Request rate thresholds
req_per_sec_warning = 50
req_per_sec_critical = 100
req_per_sec_block = 200

# Bandwidth thresholds (Mbps)
bandwidth_warning = 100
bandwidth_critical = 500

# SYN flood detection
syn_per_sec_warning = 100
syn_per_sec_critical = 500

# Block duration (seconds)
block_duration_level1 = 300      # 5 minutes
block_duration_level2 = 3600     # 1 hour
block_duration_level3 = 86400    # 24 hours
block_duration_level4 = 604800   # 7 days

[ram]
warning_percent = 80
critical_percent = 90
emergency_percent = 95

[cpu]
warning_percent = 80
critical_percent = 95
sustained_seconds = 300

[disk]
warning_percent = 80
critical_percent = 90

[system]
hang_timeout = 30
service_check_interval = 10
```

---

## ðŸ“Š Monitoring Daemon

### Daemon Architecture

```bash
# /opt/panda/monitoring/daemon/monitor_daemon.sh

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MONITOR DAEMON                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  Main Loop (every 5 seconds)                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  1. Collect Metrics                                       â”‚  â”‚
â”‚  â”‚     â”œâ”€ CPU usage                                          â”‚  â”‚
â”‚  â”‚     â”œâ”€ RAM usage                                          â”‚  â”‚
â”‚  â”‚     â”œâ”€ Disk usage                                         â”‚  â”‚
â”‚  â”‚     â”œâ”€ Network connections                                â”‚  â”‚
â”‚  â”‚     â”œâ”€ Service status                                     â”‚  â”‚
â”‚  â”‚     â””â”€ Load average                                       â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  2. Analyze & Compare with Thresholds                     â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  3. Detect Anomalies                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€ DDoS patterns                                      â”‚  â”‚
â”‚  â”‚     â”œâ”€ Resource spikes                                    â”‚  â”‚
â”‚  â”‚     â””â”€ Service failures                                   â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  4. Take Actions                                          â”‚  â”‚
â”‚  â”‚     â”œâ”€ Auto-mitigation (if enabled)                       â”‚  â”‚
â”‚  â”‚     â”œâ”€ Send alerts                                        â”‚  â”‚
â”‚  â”‚     â””â”€ Log events                                         â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â”‚  5. Update Metrics Database                               â”‚  â”‚
â”‚  â”‚                                                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  Watchdog (separate thread)                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â€¢ Check if main daemon is responsive                     â”‚  â”‚
â”‚  â”‚  â€¢ Restart daemon if frozen                               â”‚  â”‚
â”‚  â”‚  â€¢ Send alert if daemon fails                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Systemd Service

```ini
# /etc/systemd/system/panda-monitor.service

[Unit]
Description=Panda Script Monitoring Daemon
After=network.target

[Service]
Type=simple
ExecStart=/opt/panda/monitoring/daemon/monitor_daemon.sh
ExecReload=/bin/kill -HUP $MAINPID
Restart=always
RestartSec=5
StandardOutput=append:/opt/panda/data/logs/monitor.log
StandardError=append:/opt/panda/data/logs/monitor-error.log

# Resource limits
MemoryMax=128M
CPUQuota=10%

# Security
NoNewPrivileges=true
ProtectSystem=strict
ProtectHome=true
ReadWritePaths=/opt/panda/data

[Install]
WantedBy=multi-user.target
```

---

## ðŸš€ Performance Optimization

### Auto-Tuning Based on RAM

```bash
# Tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh cáº¥u hÃ¬nh theo RAM

RAM_TOTAL=$(free -m | awk '/^Mem:/{print $2}')

if [ "$RAM_TOTAL" -lt 1024 ]; then
    # 1GB RAM
    PHP_WORKERS=2
    NGINX_WORKERS=1
    MYSQL_BUFFER=128M
    OPCACHE_MEMORY=64
elif [ "$RAM_TOTAL" -lt 2048 ]; then
    # 2GB RAM
    PHP_WORKERS=4
    NGINX_WORKERS=2
    MYSQL_BUFFER=256M
    OPCACHE_MEMORY=128
elif [ "$RAM_TOTAL" -lt 4096 ]; then
    # 4GB RAM
    PHP_WORKERS=8
    NGINX_WORKERS=4
    MYSQL_BUFFER=512M
    OPCACHE_MEMORY=256
else
    # 4GB+ RAM
    PHP_WORKERS=16
    NGINX_WORKERS=auto
    MYSQL_BUFFER=1G
    OPCACHE_MEMORY=512
fi
```

### Kernel Tuning (`/etc/sysctl.d/99-panda.conf`)

```ini
# Network Performance
net.core.somaxconn = 65535
net.core.netdev_max_backlog = 65535
net.ipv4.tcp_max_syn_backlog = 65535

# TCP Optimization
net.ipv4.tcp_fin_timeout = 15
net.ipv4.tcp_keepalive_time = 300
net.ipv4.tcp_keepalive_probes = 5
net.ipv4.tcp_keepalive_intvl = 15
net.ipv4.tcp_tw_reuse = 1

# DDoS Protection
net.ipv4.tcp_syncookies = 1
net.ipv4.tcp_max_orphans = 262144
net.ipv4.tcp_synack_retries = 2
net.ipv4.tcp_syn_retries = 2

# Memory
vm.swappiness = 10
vm.dirty_ratio = 60
vm.dirty_background_ratio = 2

# File Descriptors
fs.file-max = 2097152
fs.nr_open = 2097152
```

---

## ðŸ”’ Security Architecture

### Defense in Depth

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INTERNET                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 1: CDN/Proxy (Cloudflare)                                â”‚
â”‚  â€¢ DDoS mitigation at edge                                      â”‚
â”‚  â€¢ Bot protection                                               â”‚
â”‚  â€¢ WAF rules                                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 2: Network Firewall (iptables/nftables)                  â”‚
â”‚  â€¢ Port filtering                                               â”‚
â”‚  â€¢ Rate limiting                                                â”‚
â”‚  â€¢ Geo-blocking                                                 â”‚
â”‚  â€¢ SYN flood protection                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 3: Application Firewall (fail2ban + Nginx)               â”‚
â”‚  â€¢ Brute force protection                                       â”‚
â”‚  â€¢ Bad bot blocking                                             â”‚
â”‚  â€¢ Request filtering                                            â”‚
â”‚  â€¢ Security headers                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 4: System Security (Hardening)                           â”‚
â”‚  â€¢ SSH hardening                                                â”‚
â”‚  â€¢ File permissions                                             â”‚
â”‚  â€¢ User isolation                                               â”‚
â”‚  â€¢ AIDE integrity                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Layer 5: Application Security                                   â”‚
â”‚  â€¢ PHP sandbox (disable_functions)                              â”‚
â”‚  â€¢ open_basedir                                                 â”‚
â”‚  â€¢ SQL injection prevention                                     â”‚
â”‚  â€¢ XSS protection                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“ Telegram Alert Templates

### Critical Alert Template

```
ðŸš¨ *CRITICAL ALERT*

*Server:* {{hostname}}
*Time:* {{timestamp}}
*Type:* {{alert_type}}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š *Details:*
{{details}}

âš¡ *Auto Actions Taken:*
{{actions}}

ðŸ”— *Quick Actions:*
/status - Check status
/unblock {{ip}} - Unblock IP
/restart {{service}} - Restart service
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### DDoS Alert Template

```
ðŸ”¥ *DDoS ATTACK DETECTED*

*Server:* {{hostname}}
*Time:* {{timestamp}}
*Level:* {{level}} (1-4)

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š *Attack Info:*
â€¢ Type: {{attack_type}}
â€¢ Source IPs: {{ip_count}}
â€¢ Connections/sec: {{conn_rate}}
â€¢ Bandwidth: {{bandwidth}}

ðŸŽ¯ *Top Attackers:*
{{top_ips}}

âš¡ *Mitigation:*
{{mitigation_status}}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

### RAM Alert Template

```
ðŸ’¾ *HIGH RAM USAGE*

*Server:* {{hostname}}
*Time:* {{timestamp}}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
ðŸ“Š *Memory Status:*
â€¢ Used: {{ram_used}}GB / {{ram_total}}GB
â€¢ Usage: {{ram_percent}}%
â€¢ Swap: {{swap_used}}GB / {{swap_total}}GB

ðŸ“‹ *Top Processes:*
{{top_processes}}

âš¡ *Actions:*
{{actions}}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
```

---

## ðŸ“Š Database Schema (SQLite)

```sql
-- Websites
CREATE TABLE websites (
    id INTEGER PRIMARY KEY,
    domain TEXT UNIQUE NOT NULL,
    username TEXT NOT NULL,
    document_root TEXT NOT NULL,
    php_version TEXT NOT NULL,
    ssl_enabled INTEGER DEFAULT 0,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    status TEXT DEFAULT 'active'
);

-- Metrics History
CREATE TABLE metrics (
    id INTEGER PRIMARY KEY,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    cpu_percent REAL,
    ram_percent REAL,
    disk_percent REAL,
    load_1 REAL,
    load_5 REAL,
    load_15 REAL,
    connections INTEGER,
    bandwidth_in REAL,
    bandwidth_out REAL
);

-- Alerts Log
CREATE TABLE alerts (
    id INTEGER PRIMARY KEY,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    type TEXT NOT NULL,
    severity TEXT NOT NULL,
    message TEXT NOT NULL,
    details TEXT,
    action_taken TEXT,
    acknowledged INTEGER DEFAULT 0
);

-- Blocked IPs
CREATE TABLE blocked_ips (
    id INTEGER PRIMARY KEY,
    ip_address TEXT UNIQUE NOT NULL,
    reason TEXT NOT NULL,
    blocked_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    expires_at DATETIME,
    permanent INTEGER DEFAULT 0,
    block_count INTEGER DEFAULT 1
);

-- Security Events
CREATE TABLE security_events (
    id INTEGER PRIMARY KEY,
    timestamp DATETIME DEFAULT CURRENT_TIMESTAMP,
    event_type TEXT NOT NULL,
    source_ip TEXT,
    details TEXT,
    severity TEXT
);

-- Indexes for performance
CREATE INDEX idx_metrics_timestamp ON metrics(timestamp);
CREATE INDEX idx_alerts_timestamp ON alerts(timestamp);
CREATE INDEX idx_alerts_type ON alerts(type);
CREATE INDEX idx_blocked_ips_ip ON blocked_ips(ip_address);
CREATE INDEX idx_blocked_ips_expires ON blocked_ips(expires_at);
```

---

*Document Version: 2.0.0 | Last Updated: 2025-12-26*

ðŸ¼ **Panda Script** - https://panda-script.com
